import requests
import re

def check_vulnerability(url):
    try:
        response = requests.get(url)
        
        # Extract the version of Handlebars from the server response (if available)
        version_pattern = re.compile(r"Handlebars(?:@|\s+)(\d+\.\d+\.\d+)")
        version = version_pattern.search(response.text)

        if version:
            print(f"[+] Handlebars version detected: {version.group(1)}")
            if version.group(1) < "4.7.7":
                print(f"[!] Vulnerable to CVE-2021-23383. Version: {version.group(1)}")
            else:
                print(f"[-] Handlebars version {version.group(1)} is not vulnerable.")
        else:
            print("[-] Could not detect Handlebars version.")
    except requests.RequestException as e:
        print(f"[!] Error connecting to {url}: {e}")

if __name__ == "__main__":
    target_url = input("Enter the target URL (e.g., http://example.com): ")
    check_vulnerability(target_url)
